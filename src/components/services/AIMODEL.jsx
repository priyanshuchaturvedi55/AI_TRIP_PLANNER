import { GoogleGenerativeAI } from "@google/generative-ai";
  
  const apiKey = import.meta.env.VITE_GOOGLE_GEMINI_API_KEY;
  const genAI = new GoogleGenerativeAI(apiKey);
  
  const model = genAI.getGenerativeModel({
    model: "gemini-2.0-flash",
    systemInstruction: "\n",
  });
  
  const generationConfig = {
    temperature: 1,
    topP: 0.95,
    topK: 40,
    maxOutputTokens: 8192,
    responseModalities: [
    ],
    responseMimeType: "application/json",
  };
  

   export const chatSession = model.startChat({
      generationConfig,
      history: [
        {
          role: "user",
          parts: [
            {text: "Generate Travel Plan for Location: Las Vegas, for 3 Days for Couple with a Cheap budget, Give me a Hotels options list with HotelName, Hotel address, Price, Hotel image url, geocoordinates, rating, descriptions and suggest itinerary with placeName, Place Details, Place Image Url, Geo Coordinates, ticket Pricing, rating,  Time t travel each of the location for 3 days with each day plan with best time to visit in JSON format."},
          ],
        },
        {
          role: "model",
          parts: [
            {text: "Okay, here's a possible 3-day Las Vegas itinerary for a couple on a budget, presented in JSON format, along with hotel options and details.\n\n```json\n{\n  \"Las Vegas Budget Trip for Couple (3 Days)\": {\n    \"hotels\": [\n      {\n        \"hotelName\": \"Circus Circus Hotel & Casino\",\n        \"hotelAddress\": \"2880 S Las Vegas Blvd, Las Vegas, NV 89109\",\n        \"price\": 40,\n        \"hotelImageUrl\": \"https://media-cdn.tripadvisor.com/media/photo-s/1b/8b/6c/38/circus-circus-hotel-casino.jpg\",\n        \"geoCoordinates\": {\n          \"latitude\": 36.1283,\n          \"longitude\": -115.1659\n        },\n        \"rating\": 3.5,\n        \"description\": \"A classic, budget-friendly option on the Strip with a circus theme. Features free circus acts, a large indoor amusement park (Adventuredome), and various dining options. Rooms are basic but functional.\"\n      },\n      {\n        \"hotelName\": \"Excalibur Hotel & Casino\",\n        \"hotelAddress\": \"3850 S Las Vegas Blvd, Las Vegas, NV 89109\",\n        \"price\": 55,\n        \"hotelImageUrl\": \"https://media-cdn.tripadvisor.com/media/photo-s/1b/8b/99/1c/excalibur-hotel-casino.jpg\",\n        \"geoCoordinates\": {\n          \"latitude\": 36.0984,\n          \"longitude\": -115.1744\n        },\n        \"rating\": 4.0,\n        \"description\": \"A medieval-themed hotel at the south end of the Strip. Offers affordable rooms, a variety of restaurants, and the Tournament of Kings dinner show.  Good for its location and price.\"\n      },\n      {\n        \"hotelName\": \"Luxor Hotel & Casino\",\n        \"hotelAddress\": \"3900 S Las Vegas Blvd, Las Vegas, NV 89119\",\n        \"price\": 60,\n        \"hotelImageUrl\": \"https://media-cdn.tripadvisor.com/media/photo-s/1b/8b/98/5a/luxor-hotel-casino.jpg\",\n        \"geoCoordinates\": {\n          \"latitude\": 36.0956,\n          \"longitude\": -115.1759\n        },\n        \"rating\": 4.0,\n        \"description\": \"Iconic pyramid-shaped hotel on the Strip.  Features a variety of attractions, restaurants, and shows. Rooms are located inside the pyramid or in the surrounding towers.  Generally a good value.\"\n      },\n            {\n        \"hotelName\": \"Stratosphere Tower\",\n        \"hotelAddress\": \"2000 S Las Vegas Blvd, Las Vegas, NV 89104\",\n        \"price\": 45,\n        \"hotelImageUrl\": \"https://media-cdn.tripadvisor.com/media/photo-s/1c/eb/1c/b9/the-strat-hotel-casino.jpg\",\n        \"geoCoordinates\": {\n          \"latitude\": 36.1470,\n          \"longitude\": -115.1575\n        },\n        \"rating\": 3.0,\n        \"description\": \"Offers views and thrill rides at a lower price point. Rooms are basic but clean.  Located at the northern end of the Strip, so be prepared for more travel to reach other attractions.\"\n      }\n    ],\n    \"itinerary\": {\n      \"day1\": {\n        \"theme\": \"Exploring the South Strip & Free Attractions\",\n        \"bestTimeToVisit\": \"Morning and Evening\",\n        \"activities\": [\n          {\n            \"placeName\": \"Welcome to Fabulous Las Vegas Sign\",\n            \"placeDetails\": \"Iconic sign at the south end of the Strip.  A must-do photo op!\",\n            \"placeImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Welcome_to_Las_Vegas_sign.svg/1200px-Welcome_to_Las_Vegas_sign.svg.png\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.0828,\n              \"longitude\": -115.1731\n            },\n            \"ticketPricing\": \"Free\",\n            \"rating\": 4.5,\n            \"timeToTravelFromHotel\": \"15-20 minutes (depending on hotel location and transportation - bus or ride-sharing recommended if not staying at the south end of the Strip)\"\n          },\n          {\n            \"placeName\": \"Bellagio Conservatory & Botanical Garden\",\n            \"placeDetails\": \"Stunning floral displays that change seasonally. Free to enter.\",\n            \"placeImageUrl\": \"https://www.bellagio.com/content/dam/MGM/bellagio/entertainment/conservatory-botanical-garden/bellagio-conservatory-exhibit-chinese-new-year-2024-1200x630.jpg\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.1126,\n              \"longitude\": -115.1762\n            },\n            \"ticketPricing\": \"Free\",\n            \"rating\": 4.8,\n            \"timeToTravelFromPrevious\": \"15-20 minutes (walking or short bus/tram ride)\"\n          },\n          {\n            \"placeName\": \"Bellagio Fountains\",\n            \"placeDetails\": \"Spectacular water show set to music. Free to watch. Shows run frequently in the afternoon and evening.\",\n            \"placeImageUrl\": \"https://www.bellagio.com/content/dam/MGM/bellagio/entertainment/fountains-of-bellagio/fountains-of-bellagio-daytime-1200x630.jpg\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.1126,\n              \"longitude\": -115.1762\n            },\n            \"ticketPricing\": \"Free\",\n            \"rating\": 4.9,\n            \"timeToTravelFromPrevious\": \"Located directly outside the Bellagio Conservatory\"\n          },\n          {\n            \"placeName\": \"Walk the Las Vegas Strip\",\n            \"placeDetails\": \"Experience the sights and sounds of the Strip.  People-watch, enjoy street performers, and take in the atmosphere.\",\n            \"placeImageUrl\": \"https://www.casino.org/news/wp-content/uploads/2023/02/las-vegas-strip-night-scaled.jpg\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.1146,\n              \"longitude\": -115.1728\n            },\n            \"ticketPricing\": \"Free\",\n            \"rating\": 4.5,\n            \"timeToTravelFromPrevious\": \"Continue walking south from Bellagio\"\n          },\n                     {\n            \"placeName\": \"Free shows at the LINQ Promenade\",\n            \"placeDetails\": \"Enjoy free live entertainment at the LINQ Promenade, a vibrant outdoor shopping and dining area near the High Roller Observation Wheel.\",\n            \"placeImageUrl\": \"https://www.caesars.com/content/dam/linq/amenity/the-linq-promenade/overview/linq-promenade-overview-aerial-1920x1080.jpg\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.1173,\n              \"longitude\": -115.1702\n            },\n            \"ticketPricing\": \"Free\",\n            \"rating\": 4.3,\n            \"timeToTravelFromPrevious\": \"Take a short walk or monorail ride north on the Strip.\"\n          }\n        ]\n      },\n      \"day2\": {\n        \"theme\": \"Downtown Las Vegas & Cheap Eats\",\n        \"bestTimeToVisit\": \"Afternoon and Evening\",\n        \"activities\": [\n          {\n            \"placeName\": \"Fremont Street Experience\",\n            \"placeDetails\": \"A pedestrian mall featuring a dazzling light and sound show on a massive LED canopy. Free to enter.\",\n            \"placeImageUrl\": \"https://fremontstreetexperience.com/wp-content/uploads/2023/04/FSE_Homepage_VegasYeah_Desktop_1900x730.jpg\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.1703,\n              \"longitude\": -115.1422\n            },\n            \"ticketPricing\": \"Free\",\n            \"rating\": 4.6,\n            \"timeToTravelFromHotel\": \"20-30 minutes (bus or ride-sharing from the Strip)\"\n          },\n          {\n            \"placeName\": \"Container Park\",\n            \"placeDetails\": \"An open-air shopping and entertainment complex built from shipping containers. Features unique shops, restaurants, and a playground.\",\n            \"placeImageUrl\": \"https://downtowncontainerpark.com/wp-content/uploads/2023/02/DCP-website-hero.jpg\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.1688,\n              \"longitude\": -115.1405\n            },\n            \"ticketPricing\": \"Free to enter (prices vary for shops/restaurants)\",\n            \"rating\": 4.3,\n            \"timeToTravelFromPrevious\": \"Short walk from Fremont Street\"\n          },\n          {\n            \"placeName\": \"Gold and Silver Pawn Shop (Pawn Stars)\",\n            \"placeDetails\": \"The famous pawn shop featured on the TV show \\\"Pawn Stars\\\".  See the shop and maybe catch a glimpse of the stars.\",\n            \"placeImageUrl\": \"https://www.gspawn.com/wp-content/uploads/2020/07/GSPA-Blog-01.jpg\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.1783,\n              \"longitude\": -115.1417\n            },\n            \"ticketPricing\": \"Free to enter\",\n            \"rating\": 4.0,\n            \"timeToTravelFromPrevious\": \"Short walk from Fremont street\"\n          },\n          {\n            \"placeName\": \"Eat Cheap\",\n            \"placeDetails\": \"Find affordable food options downtown.  Consider places like Heart Attack Grill (for a unique experience), pizza by the slice, or food trucks.\",\n            \"placeImageUrl\": \"https://media-cdn.tripadvisor.com/media/photo-s/02/eb/47/42/heart-attack-grill.jpg\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.1708,\n              \"longitude\": -115.1429\n            },\n            \"ticketPricing\": \"Varies - Budget $10-20 per person\",\n            \"rating\": 4.2,\n            \"timeToTravelFromPrevious\": \"Walk around downtown to find options\"\n          }\n        ]\n      },\n      \"day3\": {\n        \"theme\": \"High Roller Observation Wheel & Departure\",\n        \"bestTimeToVisit\": \"Afternoon/Early Evening (for High Roller)\",\n        \"activities\": [\n          {\n            \"placeName\": \"High Roller Observation Wheel\",\n            \"placeDetails\": \"Enjoy panoramic views of Las Vegas from the world's tallest observation wheel.  Consider going during the day for cost savings.\",\n            \"placeImageUrl\": \"https://www.caesars.com/content/dam/linq/things-to-do/high-roller/overview/the-linq-high-roller-exterior-overview-1920x1080.jpg\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.1173,\n              \"longitude\": -115.1702\n            },\n            \"ticketPricing\": \"$25-37 (depending on time of day and discounts). Book in advance for better prices.\",\n            \"rating\": 4.5,\n            \"timeToTravelFromHotel\": \"Variable, depending on hotel.  Located at the LINQ Promenade on the Strip.\"\n          },\n         {\n            \"placeName\": \"Explore the LINQ Promenade\",\n            \"placeDetails\": \"Shop for souvenirs, enjoy street performers, and grab a casual lunch.\",\n            \"placeImageUrl\": \"https://www.caesars.com/content/dam/linq/amenity/the-linq-promenade/overview/linq-promenade-overview-aerial-1920x1080.jpg\",\n            \"geoCoordinates\": {\n              \"latitude\": 36.1173,\n              \"longitude\": -115.1702\n            },\n            \"ticketPricing\": \"Varies depending on shops/restaurants\",\n            \"rating\": 4.3,\n            \"timeToTravelFromPrevious\": \"Located at the base of the High Roller\"\n          },\n\n          {\n            \"placeName\": \"Departure\",\n            \"placeDetails\": \"Head to the airport for your flight home.\",\n            \"placeImageUrl\": null,\n            \"geoCoordinates\": null,\n            \"ticketPricing\": null,\n            \"rating\": null,\n            \"timeToTravelFromPrevious\": \"Allow ample time to get to the airport (Harry Reid International Airport - LAS).\"\n          }\n        ]\n      }\n    },\n    \"budgetTips\": [\n      \"Take advantage of free attractions (Bellagio fountains, Conservatory, Fremont Street Experience).\",\n      \"Use public transportation (Deuce bus) or ride-sharing services to save on transportation costs.\",\n      \"Look for happy hour deals and cheap eats.\",\n      \"Bring your own water and snacks to avoid paying high prices on the Strip.\",\n      \"Consider visiting during the off-season (summer or weekdays) for lower hotel rates.\",\n      \"Book accommodations and shows in advance for better deals.\"\n    ]\n  }\n}\n```\n\n**Key Considerations for Budget Travelers:**\n\n*   **Transportation:** The Deuce bus is a cost-effective way to travel up and down the Strip and to Downtown.  Consider a day pass. Ride-sharing (Uber/Lyft) can also be affordable, especially if you split the fare. Avoid taxis as they are generally more expensive.\n*   **Food:** Look for happy hour deals, cheap eats downtown, and consider packing some snacks and drinks to avoid overspending on the Strip.\n*   **Entertainment:** Focus on free attractions and activities.  Consider one paid attraction, like the High Roller, and book it in advance.\n*   **Flexibility:** Be prepared to adjust your itinerary based on your budget and energy levels.\n*   **Hotel Location:** While hotels further from the Strip might be cheaper, factor in transportation costs and time when making your decision.\n\n**Important Notes:**\n\n*   **Prices are estimates and can vary.**  Check current prices before booking.\n*   **Ratings are subjective.** Read reviews from multiple sources before making a decision.\n*   **Always confirm opening hours and show times.**\n*   **Walking is a significant part of exploring the Strip.** Wear comfortable shoes.\n*   **Stay hydrated.**  Las Vegas is a desert climate.\n*   **Be aware of your surroundings and take precautions against theft.**\n\nThis itinerary is a starting point.  Customize it to your interests and preferences. Have a great trip!\n"},
          ],
        },
      ],
    });
  
    const result = await chatSession.sendMessage("INSERT_INPUT_HERE");
    // TODO: Following code needs to be updated for client-side apps.
    const candidates = result.response.candidates;
    for(let candidate_index = 0; candidate_index < candidates.length; candidate_index++) {
      for(let part_index = 0; part_index < candidates[candidate_index].content.parts.length; part_index++) {
        const part = candidates[candidate_index].content.parts[part_index];
        if(part.inlineData) {
          try {
            const filename = `output_${candidate_index}_${part_index}.${mime.extension(part.inlineData.mimeType)}`;
            fs.writeFileSync(filename, Buffer.from(part.inlineData.data, 'base64'));
            console.log(`Output written to: ${filename}`);
          } catch (err) {
            console.error(err);
          }
        }
      }
    }
    